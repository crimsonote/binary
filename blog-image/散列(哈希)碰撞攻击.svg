<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="816px" preserveAspectRatio="none" style="width:2323px;height:816px;" version="1.1" viewBox="0 0 2323 816" width="2323px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rtsg98xj50wk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#CD853F" font-family="sans-serif" font-size="30" lengthAdjust="spacingAndGlyphs" textLength="378" x="976" y="31.582">散列(哈希)碰撞攻击大致流程</text><!--cluster 签名者--><polygon fill="#ADFF2F" filter="url(#f1rtsg98xj50wk)" points="22,168.4883,32,158.4883,785,158.4883,785,271.4883,775,281.4883,22,281.4883,22,168.4883" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="775" x2="784" y1="168.4883" y2="159.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="775" y1="168.4883" y2="168.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="775" x2="775" y1="168.4883" y2="281.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="377" y="186.2266">签名者</text><!--cluster 攻击者--><polygon fill="#FF0000" filter="url(#f1rtsg98xj50wk)" points="713,342.4883,723,332.4883,1398,332.4883,1398,586.9883,1388,596.9883,713,596.9883,713,342.4883" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1388" x2="1397" y1="342.4883" y2="333.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="713" x2="1388" y1="342.4883" y2="342.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1388" x2="1388" y1="342.4883" y2="596.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="1029" y="360.2266">攻击者</text><!--cluster 验证者--><polygon fill="#1E90FF" filter="url(#f1rtsg98xj50wk)" points="1197,168.4883,1207,158.4883,2169,158.4883,2169,271.4883,2159,281.4883,1197,281.4883,1197,168.4883" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2159" x2="2168" y1="168.4883" y2="159.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1197" x2="2159" y1="168.4883" y2="168.4883"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2159" x2="2159" y1="168.4883" y2="281.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="1656.5" y="186.2266">验证者</text><!--entity 输入要签名的数据--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="38" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="48" y="251.2266">输入要签名的数据</text><!--entity 计算数据散列值并生成摘要--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="205" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="200" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="200" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="168" x="215" y="251.2266">计算数据散列值并生成摘要</text><!--entity 使用私钥加密摘要--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="428" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="423" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="423" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="438" y="251.2266">使用私钥加密摘要</text><!--entity 分发签名摘要和原始数据--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="595" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="590" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="590" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="605" y="251.2266">分发签名摘要和原始数据</text><!--entity 获取签名和原始数据并截取原始文件hash--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="729.5" y="400.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="724.5" y="405.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="724.5" y="429.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="255" x="739.5" y="425.2266">获取签名和原始数据并截取原始文件hash</text><!--entity 篡改原始数据，并使结果和给定散列值一致--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="286" x="752" y="541.9883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="747" y="546.9883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="747" y="570.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="266" x="762" y="566.7266">篡改原始数据，并使结果和给定散列值一致</text><!--entity 成功找到与给定散列值一致的文件--><rect fill="#FF4500" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="230" x="1084" y="541.9883"/><rect fill="#FF4500" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1079" y="546.9883"/><rect fill="#FF4500" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1079" y="570.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="210" x="1094" y="566.7266">成功找到与给定散列值一致的文件</text><!--entity 将原始文件替换为散列值相同的，但被篡改过的文件--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="342" x="1040" y="400.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1035" y="405.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1035" y="429.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="322" x="1050" y="425.2266">将原始文件替换为散列值相同的，但被篡改过的文件</text><!--entity pub--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1213" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1208" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1208" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="1223" y="251.2266">获取待验证的文件</text><!--entity 使用公钥解密签名摘要--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1460" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1455" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1455" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="140" x="1470" y="251.2266">使用公钥解密签名摘要</text><!--entity 计算原始数据散列值--><rect fill="#FEFECE" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="1826" y="226.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1821" y="231.4883"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1821" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="1836" y="251.2266">计算原始数据散列值</text><!--entity 比较散列值是否一致--><rect fill="#FF0000" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="2007" y="226.4883"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="2002" y="231.4883"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="2002" y="255.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="2017" y="251.2266">比较散列值是否一致</text><path d="M109.5,388.4883 L109.5,451.123 A0,0 0 0 0 109.5,451.123 L488.5,451.123 A0,0 0 0 0 488.5,451.123 L488.5,398.4883 L478.5,388.4883 L303,388.4883 L299,265.7183 L295,388.4883 L109.5,388.4883 A0,0 0 0 0 109.5,388.4883 " fill="#FBFB77" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M478.5,388.4883 L478.5,398.4883 L488.5,398.4883 L478.5,388.4883 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="115.5" y="407.1738">签名者:example  时间:2020年xx月xx日</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="115.5" y="424.7188">文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="358" x="115.5" y="442.2637">密钥指纹:0339DCAA11EA0C1ACEB36A5C7F9199B8737F508</text><path d="M804,231.9883 L804,259.5332 A0,0 0 0 0 804,259.5332 L977.48,259.5332 L880.41,400.3883 L985.48,259.5332 L1178,259.5332 A0,0 0 0 0 1178,259.5332 L1178,241.9883 L1168,231.9883 L804,231.9883 A0,0 0 0 0 804,231.9883 " fill="#FBFB77" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1168,231.9883 L1168,241.9883 L1178,241.9883 L1168,231.9883 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="810" y="250.6738">文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9</text><path d="M1417.5,388.4883 L1417.5,451.123 A0,0 0 0 0 1417.5,451.123 L1796.5,451.123 A0,0 0 0 0 1796.5,451.123 L1796.5,398.4883 L1786.5,388.4883 L1599.1,388.4883 L1547.3,265.7183 L1591.1,388.4883 L1417.5,388.4883 A0,0 0 0 0 1417.5,388.4883 " fill="#FBFB77" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1786.5,388.4883 L1786.5,398.4883 L1796.5,398.4883 L1786.5,388.4883 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="1423.5" y="407.1738">签名者:example  时间:2020年xx月xx日</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="1423.5" y="424.7188">文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="358" x="1423.5" y="442.2637">密钥指纹:0339DCAA11EA0C1ACEB36A5C7F9199B8737F508</text><path d="M1621,48.4883 L1621,93.5781 A0,0 0 0 0 1621,93.5781 L1815.34,93.5781 L1889.19,226.3383 L1823.34,93.5781 L1995,93.5781 A0,0 0 0 0 1995,93.5781 L1995,58.4883 L1985,48.4883 L1621,48.4883 A0,0 0 0 0 1621,48.4883 " fill="#FBFB77" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1985,48.4883 L1985,58.4883 L1995,58.4883 L1985,48.4883 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="1627" y="67.1738">文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="351" x="1627" y="84.7188">哈希碰撞攻击成功使篡改过的文件和签名所记载的散列值相同</text><path d="M2030.5,56.9883 L2030.5,84.5332 A0,0 0 0 0 2030.5,84.5332 L2160.16,84.5332 L2089.74,226.4683 L2168.16,84.5332 L2311.5,84.5332 A0,0 0 0 0 2311.5,84.5332 L2311.5,66.9883 L2301.5,56.9883 L2030.5,56.9883 A0,0 0 0 0 2030.5,56.9883 " fill="#FBFB77" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2301.5,56.9883 L2301.5,66.9883 L2311.5,66.9883 L2301.5,56.9883 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="2036.5" y="75.6738">尽管散列值一致，但是文件实质上已经被篡改</text><!--entity 签名验证成功--><rect fill="#FF0000" filter="url(#f1rtsg98xj50wk)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="2028" y="400.4883"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="2023" y="405.4883"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="2023" y="429.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="2038" y="425.2266">签名验证成功</text><path d="M1907,512.4883 L1907,610.2129 A0,0 0 0 0 1907,610.2129 L2253,610.2129 A0,0 0 0 0 2253,610.2129 L2253,522.4883 L2243,512.4883 L2084,512.4883 L2080,439.5083 L2076,512.4883 L1907,512.4883 A0,0 0 0 0 1907,512.4883 " fill="#87CEFA" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2243,512.4883 L2243,522.4883 L2253,522.4883 L2243,512.4883 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1913" y="531.1738">就像这样，一个被篡改过的文件被错误的通过散列值校验</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="1913" y="548.7188">并被当作原始签名所认证的原始文件而被信任。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="1913" y="566.2637">不过，对于散列碰撞攻击一般不用太过担心，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="1913" y="583.8086">碰撞一个散列相同的文件需要很多资源很长时间</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="1913" y="601.3535">才能碰撞到一个，类似于暴力破解?</text><path d="M676.5,671.4883 L676.5,804.3027 A0,0 0 0 0 676.5,804.3027 L1113.5,804.3027 A0,0 0 0 0 1113.5,804.3027 L1113.5,681.4883 L1103.5,671.4883 L899,671.4883 L895,581.1583 L891,671.4883 L676.5,671.4883 A0,0 0 0 0 676.5,671.4883 " fill="#87CEFA" filter="url(#f1rtsg98xj50wk)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1103.5,671.4883 L1103.5,681.4883 L1113.5,681.4883 L1103.5,671.4883 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="416" x="682.5" y="690.1738">最关键的步骤，一个优秀的散列算法会让此步骤所消耗的时间无法接受。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="682.5" y="707.7188">以sha1为例，以现在的技术大概需要100个显卡持续计算一年,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="682.5" y="725.2637">才能碰撞出一个sha1值相同的例子。一般没有人能够付出</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="682.5" y="742.8086">这么大成本来碰撞。所以，sha1在目前基本上是安全的。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="682.5" y="760.3535">但不建议使用，因为sha1和其他散列算法相比，被认为抗碰撞能力不足</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="409" x="682.5" y="777.8984">并且有更安全的sha256等其他散列算法，一般来说对这些散列算法碰撞</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="682.5" y="795.4434">会需要更长的时间。</text><!--link 输入要签名的数据 to 计算数据散列值并生成摘要--><path d="M170.27,245.9883 C180.12,245.9883 189.97,245.9883 199.82,245.9883 " fill="none" id="输入要签名的数据-&gt;计算数据散列值并生成摘要" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="204.97,245.9883,195.97,241.9883,199.97,245.9883,195.97,249.9883,204.97,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 计算数据散列值并生成摘要 to 使用私钥加密摘要--><path d="M393.07,245.9883 C402.92,245.9883 412.77,245.9883 422.62,245.9883 " fill="none" id="计算数据散列值并生成摘要-&gt;使用私钥加密摘要" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="427.77,245.9883,418.77,241.9883,422.77,245.9883,418.77,249.9883,427.77,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 使用私钥加密摘要 to 分发签名摘要和原始数据--><path d="M560.09,245.9883 C569.96,245.9883 579.83,245.9883 589.7,245.9883 " fill="none" id="使用私钥加密摘要-&gt;分发签名摘要和原始数据" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="594.86,245.9883,585.86,241.9883,589.86,245.9883,585.86,249.9883,594.86,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 分发签名摘要和原始数据 to 获取签名和原始数据并截取原始文件hash--><path d="M702.15,265.7183 C736.49,297.6483 806.18,362.4383 842.99,396.6583 " fill="none" id="分发签名摘要和原始数据-&gt;获取签名和原始数据并截取原始文件hash" style="stroke: #00FF00; stroke-width: 1.0;"/><polygon fill="#00FF00" points="846.87,400.2783,842.9845,391.2283,843.2015,396.881,837.5488,397.0979,846.87,400.2783" style="stroke: #00FF00; stroke-width: 1.0;"/><!--link 获取签名和原始数据并截取原始文件hash to 篡改原始数据，并使结果和给定散列值一致--><path d="M870.72,439.5083 C875.76,464.6283 884.77,509.4983 890.28,536.9683 " fill="none" id="获取签名和原始数据并截取原始文件hash-&gt;篡改原始数据，并使结果和给定散列值一致" style="stroke: #00FF00; stroke-width: 1.0;"/><polygon fill="#00FF00" points="891.27,541.8883,893.4165,532.2762,890.2839,536.9865,885.5736,533.8539,891.27,541.8883" style="stroke: #00FF00; stroke-width: 1.0;"/><!--link 篡改原始数据，并使结果和给定散列值一致 to 成功找到与给定散列值一致的文件--><path d="M1038.09,561.4883 C1051.72,561.4883 1065.34,561.4883 1078.96,561.4883 " fill="none" id="篡改原始数据，并使结果和给定散列值一致-&gt;成功找到与给定散列值一致的文件" style="stroke: #00FF00; stroke-width: 1.0;"/><polygon fill="#00FF00" points="1083.98,561.4883,1074.98,557.4883,1078.98,561.4883,1074.98,565.4883,1083.98,561.4883" style="stroke: #00FF00; stroke-width: 1.0;"/><!--reverse link 将原始文件替换为散列值相同的，但被篡改过的文件 to 成功找到与给定散列值一致的文件--><path d="M1208.95,444.7683 C1206.59,472.2283 1202.76,516.8383 1200.6,541.8883 " fill="none" id="将原始文件替换为散列值相同的，但被篡改过的文件&lt;-成功找到与给定散列值一致的文件" style="stroke: #00FF00; stroke-width: 1.0;"/><polygon fill="#00FF00" points="1209.41,439.5083,1204.6539,448.1326,1208.9818,444.4899,1212.6245,448.8178,1209.41,439.5083" style="stroke: #00FF00; stroke-width: 1.0;"/><!--link 分发签名摘要和原始数据 to pub--><path d="M696.04,226.4183 C714.05,203.1883 747.7,165.6883 787,150.4883 C871.77,117.7083 1113.3,112.7883 1196,150.4883 C1229.98,165.9783 1255.43,203.0083 1268.7,226.1383 " fill="none" id="分发签名摘要和原始数据-pub" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="858.5" y="138.1738">被劫持</text><!--reverse link pub to 将原始文件替换为散列值相同的，但被篡改过的文件--><path d="M1269.66,270.5983 C1256.01,305.1383 1230.86,368.7583 1218.4,400.2783 " fill="none" id="pub&lt;-将原始文件替换为散列值相同的，但被篡改过的文件" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1271.59,265.7183,1264.5518,272.6077,1269.7454,270.3656,1271.9875,275.5591,1271.59,265.7183" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="1259" y="312.1738">将篡改过的文件和原始签名分发给受害者</text><!--link pub to 使用公钥解密签名摘要--><path d="M1345.2,245.9883 C1378.45,245.9883 1419.13,245.9883 1454.69,245.9883 " fill="none" id="pub-&gt;使用公钥解密签名摘要" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1459.9,245.9883,1450.9,241.9883,1454.9,245.9883,1450.9,249.9883,1459.9,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1363.5" y="238.6738">输入签名摘要</text><!--link 使用公钥解密签名摘要 to 计算原始数据散列值--><path d="M1620.12,245.9883 C1679.9,245.9883 1761.15,245.9883 1820.53,245.9883 " fill="none" id="使用公钥解密签名摘要-&gt;计算原始数据散列值" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1825.84,245.9883,1816.84,241.9883,1820.84,245.9883,1816.84,249.9883,1825.84,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1638.5" y="238.6738">成功从摘要文件内提取散列值</text><!--link 计算原始数据散列值 to 比较散列值是否一致--><path d="M1972.18,245.9883 C1981.98,245.9883 1991.78,245.9883 2001.59,245.9883 " fill="none" id="计算原始数据散列值-&gt;比较散列值是否一致" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2006.71,245.9883,1997.71,241.9883,2001.71,245.9883,1997.71,249.9883,2006.71,245.9883" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 比较散列值是否一致 to 签名验证成功--><path d="M2080,265.7183 C2080,297.1283 2080,360.3483 2080,394.9783 " fill="none" id="比较散列值是否一致-&gt;签名验证成功" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2080,400.2783,2084,391.2783,2080,395.2783,2076,391.2783,2080,400.2783" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="2081" y="312.1738">一致</text><!--
@startuml
skinparam TitleFontSize 30
skinparam TitleFontColor peru
title 散列(哈希)碰撞攻击大致流程


node "签名者" #greenyellow {
      [输入要签名的数据] -> [计算数据散列值并生成摘要] 
      [计算数据散列值并生成摘要] -> [使用私钥加密摘要]
      [使用私钥加密摘要] -> [分发签名摘要和原始数据]

}

note bottom of [计算数据散列值并生成摘要] : 签名者:example  时间:2020年xx月xx日\n文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9\n密钥指纹:0339DCAA11EA0C1ACEB36A5C7F9199B8737F508


node "攻击者" #red {
      [分发签名摘要和原始数据] -[#lime]down-> [获取签名和原始数据并截取原始文件hash] 
      [获取签名和原始数据并截取原始文件hash] -[#lime]-> [篡改原始数据，并使结果和给定散列值一致]	
      [成功找到与给定散列值一致的文件] #orangered
      [篡改原始数据，并使结果和给定散列值一致] -[#lime]> [成功找到与给定散列值一致的文件] #red
      [成功找到与给定散列值一致的文件] -[#lime]up-> [将原始文件替换为散列值相同的，但被篡改过的文件]
}

note top of  [获取签名和原始数据并截取原始文件hash] : 文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9

node "验证者" #dodgerblue {
      [获取待验证的文件] as pub
      [分发签名摘要和原始数据] . pub :被劫持
      [将原始文件替换为散列值相同的，但被篡改过的文件] -up-> pub :将篡改过的文件和原始签名分发给受害者
      pub -> [使用公钥解密签名摘要] :输入签名摘要
      [使用公钥解密签名摘要] ->  [计算原始数据散列值] :成功从摘要文件内提取散列值
      [比较散列值是否一致] #red
      [计算原始数据散列值] -> [比较散列值是否一致]
}
note bottom of  [使用公钥解密签名摘要] : 签名者:example  时间:2020年xx月xx日\n文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9\n密钥指纹:0339DCAA11EA0C1ACEB36A5C7F9199B8737F508
note top of  [计算原始数据散列值] : 文件SHA1:b8d51a989a85d4486f239bdd91ec5142dacbffb9\n哈希碰撞攻击成功使篡改过的文件和签名所记载的散列值相同
note top of  [比较散列值是否一致] : 尽管散列值一致，但是文件实质上已经被篡改
[签名验证成功] #red
[比较散列值是否一致] - -> [签名验证成功] :一致
note bottom of [签名验证成功] #lightskyblue
      就像这样，一个被篡改过的文件被错误的通过散列值校验
      并被当作原始签名所认证的原始文件而被信任。
      不过，对于散列碰撞攻击一般不用太过担心，
      碰撞一个散列相同的文件需要很多资源很长时间
      才能碰撞到一个，类似于暴力破解?
      end note 
note bottom of  [篡改原始数据，并使结果和给定散列值一致] #lightskyblue
      最关键的步骤，一个优秀的散列算法会让此步骤所消耗的时间无法接受。
      以sha1为例，以现在的技术大概需要100个显卡持续计算一年,
      才能碰撞出一个sha1值相同的例子。一般没有人能够付出
      这么大成本来碰撞。所以，sha1在目前基本上是安全的。
      但不建议使用，因为sha1和其他散列算法相比，被认为抗碰撞能力不足
      并且有更安全的sha256等其他散列算法，一般来说对这些散列算法碰撞
      会需要更长的时间。
      end note
@enduml

PlantUML version 1.2019.09(Tue Aug 27 00:19:51 CST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
OS Version: 5.4.52-1-MANJARO
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>