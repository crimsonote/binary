<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="361px" preserveAspectRatio="none" style="width:1173px;height:361px;" version="1.1" viewBox="0 0 1173 361" width="1173px" zoomAndPan="magnify"><defs><filter height="300%" id="f1gdrdkde3kor3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#CD853F" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="216" x="482" y="18.9492">针对哈希校验和篡改的攻击</text><!--cluster 文件发布--><polygon fill="#ADFF2F" filter="url(#f1gdrdkde3kor3)" points="22,48.293,88,48.293,95,73.1875,513,73.1875,513,140.293,22,140.293,22,48.293" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="95" y1="73.1875" y2="73.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="26" y="65.0313">文件发布</text><!--cluster 文件发布服务器--><path d="M306.0057,235.1904 C308.9828,228.9815 314.0779,228.8568 318.4449,233.6139 C320.5512,228.5729 323.9867,226.7408 328.596,230.8313 C331.4405,224.9178 336.2161,224.2719 340.7027,228.9553 C342.4386,222.8666 346.1089,222.7648 350.7438,225.7458 C356.2824,220.4898 360.3184,220.9417 362.9723,228.4989 C367.6547,223.8121 372.4494,224.4941 374.2075,231.3463 C378.3372,225.5151 383.5794,226.7529 386.2395,232.8311 C394.7179,228.3422 402.3807,230.2155 403,241.293 C403.7624,240.6187 404.4417,240.8413 404.8437,241.7207 C410.7735,246.1841 411.6132,252.1788 404.2362,256.0793 C410.8631,259.6725 412.2805,265.5689 405.3414,270.2223 C411.9928,274.3832 413.362,279.9369 406.8277,285.3899 C413.9703,291.0253 412.9836,295.9824 405.2987,300.0738 C410.468,304.6047 410.6557,309.9433 404.1292,313.4517 C411.0839,323.4752 407.287,330.7434 396,333.293 C396.6184,332.3046 397.6013,332.428 398.189,333.3285 C397.0027,340.2569 391.8247,341.1721 386.7374,337.5711 C383.6881,343.4658 378.3044,344.5834 374.409,338.4375 C372.5713,345.2186 367.5931,346.3768 362.9655,341.0811 C360.3329,347.6814 356.1379,349.5114 350.6876,343.9182 C346.2461,348.0821 341.3438,346.6982 340.1513,340.5867 C334.7899,345.1682 330.4283,344.7031 327.8144,337.6687 C324.3107,341.7348 319.5932,340.8726 317.5743,335.9728 C307.6945,341.6954 298.458,339.623 298,326.293 C298.5467,325.8534 298.9273,325.8953 299.1534,326.6126 C292.316,324.4277 292.0947,317.7089 296.7783,313.4458 C289.5427,309.4032 288.6075,304.3779 295.1227,298.7827 C288.6927,295.8051 287.8467,289.8093 293.5466,285.4028 C286.0578,280.0498 285.8398,274.9406 293.9637,270.0108 C287.8047,263.5653 289.4221,257.9941 297.9603,255.6346 C288.91,244.7939 293.1084,238.2258 305,234.293 C305.6647,234.1584 306.1847,234.3795 306.0057,235.1904 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="298" y="254.0313">文件发布服务器</text><!--cluster 恶意分发者--><path d="M631.6981,58.7879 C640.1193,43.196 650.6276,46.0063 659.9049,57.9096 C665.6454,44.8125 674.2931,42.9383 684.2375,53.6051 C691.6846,40.3873 704.4944,38.374 711.9869,53.5607 C718.647,38.6897 731.4298,41.1464 738.7347,52.9131 C745.5087,39.4662 759.1597,34.4046 768.6601,50.1149 C775.5993,39.5198 785.8178,41.0791 791.5678,51.4163 C798.3124,36.8 812.1924,35.5595 819.9954,50.3947 C825.8465,37.2227 838.5548,34.9907 846.8827,47.835 C857.0174,34.4195 868.9897,38.3155 875.0558,52.0561 C883.0386,40.699 892.9065,44.5808 898.3142,54.8283 C906.7982,41.0903 918.2958,41.8255 926.0432,55.5714 C933.2084,44.1531 944.5513,43.0215 951.6072,55.6875 C960.7914,40.4105 971.463,40.4123 981.3086,55.0303 C991.2232,44.0657 1001.459,42.5351 1008.6758,57.8408 C1029.7899,66.3007 1027.969,85.4841 1011.6117,96.77 C1028.6352,113.2741 1027.5918,124.7795 1005.0043,134.3119 C999.1483,146.1794 989.6657,147.9611 981.8225,136.267 C974.1825,150.6488 960.2102,149.6256 952.2217,136.6441 C948.2211,149.0268 936.0812,152.8381 927.1173,142.0131 C918.255,155.3094 904.2805,155.7319 898.041,139.436 C893.7829,151.9531 882.4454,152.8497 874.5895,143.251 C867.6156,157.9681 854.5592,156.8286 845.5124,145.5715 C840.1542,155.8227 828.8774,159.905 821.7621,147.4057 C812.9267,158.6396 802.9613,158.2794 794.5721,146.87 C783.8384,157.9429 774.1196,156.1951 766.6171,143.1281 C757.1559,156.2689 746.9746,154.288 739.471,141.109 C732.1601,150.8591 722.1814,153.9958 715.1945,140.7666 C705.5928,152.6055 692.8789,150.1241 687.1533,136.4983 C678.2344,148.2 664.9244,150.0481 657.5329,134.8184 C647.7119,147.1492 640.0089,146.7842 632.6063,132.5492 C614.7929,123.7047 616.3019,108.7688 630.7255,98.161 C614.7822,85.6878 615.2065,70.4598 631.6981,58.7879 " fill="#FF0000" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="780" y="76.0313">恶意分发者</text><!--cluster 文件接收--><polygon fill="#1E90FF" filter="url(#f1gdrdkde3kor3)" points="435,237.793,501,237.793,508,262.6875,1099,262.6875,1099,329.793,435,329.793,435,237.793" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="435" x2="508" y1="262.6875" y2="262.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="439" y="254.5313">文件接收</text><!--entity 计算待发布文件hash--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="37.5" y="85.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="90.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="114.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="47.5" y="110.0313">计算待发布文件hash</text><!--entity 将待发布文件和文件hash上传至发布网站--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="221.5" y="85.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="216.5" y="90.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="216.5" y="114.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="255" x="231.5" y="110.0313">将待发布文件和文件hash上传至发布网站</text><!--entity 发布页面--><ellipse cx="359" cy="294.293" fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="331" y="326.0313">发布页面</text><!--entity 截取篡改原始文件--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="638" y="85.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="633" y="90.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="633" y="114.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="648" y="110.0313">截取篡改原始文件</text><!--entity 针对篡改后的文件生成hash--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="805.5" y="85.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="800.5" y="90.293"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="800.5" y="114.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="815.5" y="110.0313">针对篡改后的文件生成hash</text><!--entity 获取文件和hash--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="961.5" y="274.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="956.5" y="279.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="956.5" y="303.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="971.5" y="299.5313">获取文件和hash</text><!--entity 本地计算文件hash值--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="777.5" y="274.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="772.5" y="279.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="772.5" y="303.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="787.5" y="299.5313">本地计算文件hash值</text><!--entity 比较hash值是否一致--><rect fill="#FEFECE" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="593.5" y="274.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="588.5" y="279.793"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="588.5" y="303.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="603.5" y="299.5313">比较hash值是否一致</text><!--entity 校验通过!--><rect fill="#FF0000" filter="url(#f1gdrdkde3kor3)" height="38.8945" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="451" y="274.793"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="446" y="279.793"/><rect fill="#FF0000" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="446" y="303.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="461" y="299.5313">校验通过!</text><!--link 计算待发布文件hash to 将待发布文件和文件hash上传至发布网站--><path d="M186.78,104.793 C196.61,104.793 206.44,104.793 216.28,104.793 " fill="none" id="计算待发布文件hash-&gt;将待发布文件和文件hash上传至发布网站" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="221.42,104.793,212.42,100.793,216.42,104.793,212.42,108.793,221.42,104.793" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 将待发布文件和文件hash上传至发布网站 to 发布页面--><path d="M359,124.453 C359,162.283 359,247.183 359,279.993 " fill="none" id="将待发布文件和文件hash上传至发布网站-&gt;发布页面" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="359,285.143,363,276.143,359,280.143,355,276.143,359,285.143" style="stroke: #A80036; stroke-width: 1.0;"/><!--reverse link 截取篡改原始文件 to 发布页面--><path d="M636.31,126.053 C579.66,144.833 498.19,176.213 435,218.293 C405.37,238.023 377.44,270.343 365.32,285.273 " fill="none" id="截取篡改原始文件&lt;-发布页面" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="641.37,124.383,631.5722,123.3812,636.6181,125.9384,634.0609,130.9843,641.37,124.383" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 截取篡改原始文件 to 针对篡改后的文件生成hash--><path d="M770.18,104.793 C780.19,104.793 790.2,104.793 800.21,104.793 " fill="none" id="截取篡改原始文件-&gt;针对篡改后的文件生成hash" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="805.44,104.793,796.44,100.793,800.44,104.793,796.44,108.793,805.44,104.793" style="stroke: #A80036; stroke-width: 1.0;"/><!--link 针对篡改后的文件生成hash to 获取文件和hash--><path d="M913.04,124.453 C935.33,158.993 982.94,232.763 1007.17,270.313 " fill="none" id="针对篡改后的文件生成hash-&gt;获取文件和hash" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1010,274.703,1008.4745,264.973,1007.2861,270.5036,1001.7555,269.3152,1010,274.703" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="966" y="170.9785">如果一个劫持者有能力篡改文件，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="979" y="188.5234">那么，顺便再篡改一下校验和</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="998.5" y="206.0684">也不会提高太多难度。</text><!--reverse link 本地计算文件hash值 to 获取文件和hash--><path d="M931.85,294.293 C941.67,294.293 951.5,294.293 961.33,294.293 " fill="none" id="本地计算文件hash值&lt;-获取文件和hash" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="926.71,294.293,935.71,298.293,931.71,294.293,935.71,290.293,926.71,294.293" style="stroke: #A80036; stroke-width: 1.0;"/><!--reverse link 比较hash值是否一致 to 本地计算文件hash值--><path d="M747.88,294.293 C757.69,294.293 767.51,294.293 777.32,294.293 " fill="none" id="比较hash值是否一致&lt;-本地计算文件hash值" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="742.75,294.293,751.75,298.293,747.75,294.293,751.75,290.293,742.75,294.293" style="stroke: #A80036; stroke-width: 1.0;"/><!--reverse link 校验通过! to 比较hash值是否一致--><path d="M536.43,294.293 C553.71,294.293 573.88,294.293 593.17,294.293 " fill="none" id="校验通过!&lt;-比较hash值是否一致" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="531.16,294.293,540.16,298.293,536.16,294.293,540.16,290.293,531.16,294.293" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="549.25" y="286.9785">一致</text><!--
@startuml
skinparam TitleFontColor peru
title 针对哈希校验和篡改的攻击

package "文件发布" #greenyellow {
[计算待发布文件hash] -> [将待发布文件和文件hash上传至发布网站]
}
cloud "文件发布服务器" {
[将待发布文件和文件hash上传至发布网站] -down-> () 发布页面
() 发布页面
}
cloud "恶意分发者" #red {
发布页面 -up-> [截取篡改原始文件]
[截取篡改原始文件] -> [针对篡改后的文件生成hash]
}
package "文件接收" #dodgerblue {
[针对篡改后的文件生成hash] -down-> [获取文件和hash] :如果一个劫持者有能力篡改文件，\n那么，顺便再篡改一下校验和\n也不会提高太多难度。
[获取文件和hash] -left-> [本地计算文件hash值]
[本地计算文件hash值] -left-> [比较hash值是否一致]
[校验通过!] #red
[比较hash值是否一致] -left-> [校验通过!] : 一致
}
@enduml

PlantUML version 1.2019.09(Tue Aug 27 00:19:51 CST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
OS Version: 5.4.52-1-MANJARO
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>